Эхлээд ямар ч байсан 1 үйлдлээр дуусгаж чадах эсэхийг шалгана.

Өгөгдсөн нөхцөлөөс $b$-ийн нийт нийлбэр нь тэгш тоо байх ёстой болно. Тиймээс үйлдэл бүрд $a$-ийн нийт нийлбэр тэгш тоогоор багасах тул энэ нийлбэр нь анх сондгой байвал хариу -1.

$s(l,r)=a_l+a_{l+1}+...+a_r$ гэе. $s(1,i)>s(i+1,n)$ байх хамгийн бага $i$-г $k$ гэе. $s(1,k)>s(k+1,n)$ ба $s(1,k-1)<s(k,n)$ байна. 2 үйлдлээр дуусгаж чаддаг гэж таамаглаад (шалтгаан нь жишээ нь хэрэв 10 үйлдлээр багадаа хийдэг бол 9 үйлдлээр хийж чаддаггүй байхыг баттай мэддэг байх нь хэтэрхий сонин гэж бодоод) хэрэв 1 үйлдлээр $s(1,k)$-г $s(k+1,n)$ болгож багасгах$`(*)`$ эсвэл $s(k,n)$-г $s(1,k-1)$ болгож багасгаж$`(**)`$ чадвал үүний дараа 1 үйлдэл хийхэд хангалттай. $`(*)`$ ба $`(**)`$ нь төстэй тул үүнээс цааш зөвхөн $`(*)`$-ийг сонирхъё. $`(*)`$ гэдэг нь $b_{k+1}=b_{k+2}=...=b_n=0$ байхаар буюу зөвхөн $a_1,a_2,...,a_k$ ууд л хасагдах байдлаар үйлдэл хийсний дараа $s(1,k)=s(k+1,n)$ болохыг хэлнэ. Ер нь бол $[1,k]$-г зүүн хэсэг, $[k+1,n]$-г баруун хэсэг гэвэл 1 үйлдэл хийж зүүн хэсгийн нийлбэрийг багасгаж баруун хэсгийнхтэй тэнцүү болгоод дараа нь 1 үйлдэл хийгээд дуусгах зорилготой.

Ингэхийн тулд зүүн хэсгээс нийтдээ $d=s(1,k)-s(k+1,n)$ хасагдах ёстой. $s(1,k)+s(k+1,n)=s(1,n)$ тэгш тул $d$ нь тэгш байна. $s(1,k-1)<s(k,n) \implies s(1,k-1)-s(k+1,n)<a_k \implies s(1,k)-s(k+1,n)<2a_k \implies d/2<a_k$ байна. Хэрэв $s(1,k-1) \ge d/2$ бол $b_k=d/2$ гээд $b_1,b_2,...,b_{k-1}$-үүдийг нийлбэр нь $d/2$ байхаар сонгоод $`(*)`$-ийг 1 үйлдлээр хийж чадна. Үүний дараа $b_i=a_i$ гэж нэг үйлдэл хийснээр нийт 2 үйлдэл хийнэ.

Хэрэв дээрх байдлаар $`(*)`$ болон $`(**)`$-г аль алиныг нь хийж чадахгүй бол, өөрөөр хэлбэл тус тус $s(1,k-1)<\dfrac{s(1,k)-s(k+1,n)}{2}$ ба $s(k+1,n)<\dfrac{s(k,n)-s(1,k-1)}{2}$ бол, хариу -1 байна. Яагаад гэвэл $s(1,k-1)+s(k+1,n)<\dfrac{s(1,k)-s(k+1,n)}{2}+\dfrac{s(k,n)-s(1,k-1)}{2}=a_k$ буюу $a_1+...+a_{k-1}+a_{k+1}+...+a_n<a_k$ байна. Үйлдэл бүрд $b_1+...+b_{k-1}+b_{k+1}+...+b_n \ge b_k$ байх ёстой (үгүй бол нөхцөл хангаж чадахгүй). Эндээс $a_k$ нь 0 болж чадахгүй ($a_k$-аас бусад тоонууд нийлээд $a_k$-ийн багасаж байгаа хэмжээнээс багагүй хэмжээгээр багасах ёстой боловч тэдний нийлбэр нь $a_k$-аас бага буюу $a_k$-нь хэтэрхий их байна).

**Time complexity:** $O(n)$\
[Submission](https://codeforces.com/contest/2124/submission/327781132)
