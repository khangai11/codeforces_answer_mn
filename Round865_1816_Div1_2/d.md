Бодолт: 
1 дэх query-д x=(n+1) болон x=(n+2) гэсэн тоо өгвөл үүсэх граф маань урт шулуун болно.(Зураад үзээрэй)
Үүний дараа үүсэх шулууны хамгийн захын цэгийг хайна.Хайхдаа
i=1,j=2..n гэсэн (n-1) query2 хийх үед хамгийн хол зайтай нь шулууны хамгийн захын цэг байж таарна. тэр индексийг нь ind гэе.
Үүний дараа
i=ind, j=1..n(j!=ind) байхаар query2 хийнэ. query2-н хариу нь уг тоо нь хэрчмийн үзүүрээс тоолоод хэд дэх тоо гэдгийг нь илэрхийлнэ.
ind дэх тоо маань шулууны эхлэлийн цэг байх үе болон төгсгөлийн цэг байх үеийн 2 хариуг үүсгэхэд хангалттай.