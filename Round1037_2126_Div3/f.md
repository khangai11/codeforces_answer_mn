$c$-г тухайн ирмэгийн жин гэе. Хариу нь (нийт жингүүдийн нийлбэр)-(ижил өнгөтэй 2 оройг холбосон ирмэгүүдийн жингүүдийн) байна. Иймд ижил өнгөтэй 2 оройг холбох ирмэгүүдийг "сайн" гээд тэдгээрийн нийт жинг олъё.\
Ямар нэг $T$-ийн хувьд өнгө нь ядаж $T$ удаа солигддог оройг "их", бусдыг нь "бага" гэе.\
Их оройнуудын хувьд бүх шинэчлэлтүүдээ нэг нэгээр нь хийгээд тухай бүрд нь түүнтэй холбоотой сайн ирмэгүүдийн нийт жинг нийт $O(q)$ хугацаанд хадгалаад яваад байж чадна. Ингэхдээ 2 их оройг холбосон ирмэгийг давхар тооцохгүй байх хэрэгтэй. Үүнийг бүх их оройн хувьд хийсний дараа зөвхөн 2 бага оройг холбох ирмэгүүд үлдэнэ.\
Бага оройнуудыг тэдээс тэддүгээр шинэчлэлтүүдийн дараа дандаа ижил тийм өнгөтэй байна гэх байдлаар $O(T)$ төлөвтэй гэж болно. 2 бага оройг холбох ирмэг бүрийн хувьд тэр 2 оройн төлөвүүдээр 2 pointers ашиглаж гүйгээд тэр 2 орой тэдээс тэддүгээр шинэчлэлтийн хооронд адилхан өнгөтэй байсан байна гэж $O(T)$ хугацаанд олоод үүнийг хариун дээрээ тооцож өгсөнөөр бодлого $O\left(\dfrac{q^2}{T}+nT\right)$ хугацаанд бодогдоно. $T\approx\sqrt{q}$ гэж $T$-г сонгоход хангалттай.

**Time complexity: $O((n+q)\sqrt{q})$**\
[Submission](https://codeforces.com/contest/2126/submission/329481299)