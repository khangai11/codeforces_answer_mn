Үсрэлтүүдээ зөвхөн $h_j \ge h_i$ байхаар хийх нь ашигтай. Өөрөөр хэлбэл, $h_j < h_i$ байх үсрэлт хийдэг бол заавал ингэж үсрэхгүйгээр эцэст нь муугүй үр дүнд хүрч чадна.\
Мөн $i$-ээс $j$-рүү үсэрсэн үед $h_i<h_k<h_j$ байх $k$ индекстэй цамхаг байдаг бол тэр цамхагаар дамжаад $i$-ээс $k$-руу, $k$-аас $j$-рүү үсэрч чадна. Иймд өөрийн байгаа цамхагаасаа өндөр цамхагуудын хамгийн намхан руу нь үсэрч чадаж байвал үсрээд яваад байхад болно.

**Time complexity:** $O(n\log n)$\
[Submission](https://codeforces.com/contest/2126/submission/329375650)